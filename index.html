<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Notes - TF24B</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .note-card { transition: all 0.2s; cursor: pointer; }
        .note-card:hover { transform: translateY(-2px); filter: brightness(95%); }
        .note-0 { background-color: #e0f2fe; border-left: 8px solid #0ea5e9; color: #0369a1; } 
        .note-1 { background-color: #fce7f3; border-left: 8px solid #ec4899; color: #9d174d; } 
        .note-2 { background-color: #dcfce7; border-left: 8px solid #16a34a; color: #166534; } 
        .note-3 { background-color: #fef9c3; border-left: 8px solid #ca8a04; color: #854d0e; } 
    </style>
</head>
<body class="bg-gradient-to-br from-blue-700 to-cyan-500 font-sans min-h-screen">

    <div id="authSection" class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white p-8 rounded-[40px] shadow-2xl w-full max-w-md">
            <div class="text-center mb-6">
                <div class="w-20 h-20 bg-cyan-400 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg">
                    <i class="fas fa-user-graduate text-4xl text-blue-900"></i>
                </div>
                <h1 class="text-lg font-black text-gray-800 tracking-tighter uppercase">Digital Notes TF24B</h1>
            </div>

            <div id="loginForm" class="fade-in">
                <h2 class="text-2xl font-bold text-center text-blue-900 mb-10 uppercase font-black">LOGIN</h2>
                <div class="space-y-8">
                    <input type="text" id="logUser" placeholder="Username" class="w-full p-2 bg-transparent border-b-2 border-gray-300 outline-none focus:border-cyan-500">
                    <div>
                        <input type="password" id="logPass" placeholder="Password" class="w-full p-2 bg-transparent border-b-2 border-gray-300 outline-none focus:border-cyan-500">
                        <div class="text-right mt-2">
                            <button onclick="toggleAuth('reset')" class="text-[11px] text-red-400 font-bold hover:underline italic">Ubah Password?</button>
                        </div>
                    </div>
                    <button onclick="login()" class="w-full bg-cyan-400 hover:bg-cyan-500 text-white font-black py-4 rounded-2xl shadow-lg uppercase">MASUK</button>
                    <p class="text-center text-[11px] text-gray-400 mt-6 italic">Belum punya akun? <a href="javascript:void(0)" onclick="toggleAuth('reg')" class="text-cyan-500 font-bold underline">Daftar di sini</a></p>
                </div>
            </div>

            <div id="regForm" class="hidden fade-in">
                <h2 class="text-2xl font-bold text-center text-blue-900 mb-8 uppercase font-black">DAFTAR AKUN</h2>
                <div class="space-y-4">
                    <div>
                        <input type="text" id="regNim" placeholder="NIM" class="w-full p-3 bg-gray-50 border-2 border-cyan-200 rounded-xl outline-none focus:border-cyan-500">
                        <p class="text-[11px] text-black mt-1 ml-1 font-medium italic">masukan Nim anda</p>
                    </div>
                    <div>
                        <input type="text" id="regUser" maxlength="20" placeholder="Username" class="w-full p-3 bg-gray-50 border-2 border-cyan-200 rounded-xl outline-none focus:border-cyan-500">
                        <p class="text-[11px] text-black mt-1 ml-1 font-medium italic">karakter (8–20)</p>
                    </div>
                    <div>
                        <input type="password" id="regPass" maxlength="20" placeholder="Password" class="w-full p-3 bg-gray-50 border-2 border-cyan-200 rounded-xl outline-none focus:border-cyan-500">
                        <p class="text-[11px] text-black mt-1 ml-1 font-medium italic">karakter (8–20)</p>
                    </div>
                    <button onclick="daftar()" class="w-full bg-cyan-500 hover:bg-cyan-600 text-white font-black py-3 rounded-xl shadow-lg transition uppercase">Daftar Sekarang</button>
                    <p class="text-center text-[11px] text-gray-400 mt-4 italic"><a href="javascript:void(0)" onclick="toggleAuth('login')" class="text-cyan-500 font-bold underline">Kembali ke Login</a></p>
                </div>
            </div>

            <div id="resetForm" class="hidden fade-in">
                <h2 class="text-2xl font-bold text-center text-blue-900 mb-8 uppercase font-black">SIMPAN PERUBAHAN</h2>
                <div class="space-y-4">
                    <input type="text" id="resNim" placeholder="NIM" class="w-full p-3 bg-gray-50 border-2 border-cyan-200 rounded-xl outline-none focus:border-cyan-500">
                    <p class="text-[11px] text-black mt-1 ml-1 font-medium italic">masukan Nim anda</p>
                    <input type="text" id="resUser" placeholder="Username" class="w-full p-3 bg-gray-50 border-2 border-cyan-200 rounded-xl outline-none focus:border-cyan-500">
                     <p class="text-[11px] text-black mt-1 ml-1 font-medium italic">karakter (8–20)</p>
                    <input type="password" id="resPass" placeholder="Password Baru" class="w-full p-3 bg-gray-50 border-2 border-cyan-200 rounded-xl outline-none focus:border-cyan-500">
                    <p class="text-[11px] text-black mt-1 ml-1 font-medium italic">karakter (8–20)</p>
                    <button onclick="prosesUbahPassword()" class="w-full bg-cyan-400 hover:bg-cyan-500 text-white font-black py-4 rounded-2xl shadow-lg uppercase mt-4">SIMPAN PERUBAHAN PASSWORD</button>
                    <p class="text-center text-[11px] text-gray-400 mt-4 italic"><a href="javascript:void(0)" onclick="toggleAuth('login')" class="text-blue-600 font-bold underline">Batal</a></p>
                </div>
            </div>
        </div>
    </div>

    <div id="dashboardSection" class="hidden min-h-screen bg-gray-100 flex flex-col md:flex-row">
        <div class="w-full md:w-72 bg-blue-900 text-white p-8 border-r-4 border-cyan-400">
            <div class="text-center mb-10">
                <div class="w-16 h-16 bg-cyan-400 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg"><i class="fas fa-user-graduate text-3xl text-blue-900"></i></div>
                <p id="navUser" class="text-xs font-bold text-cyan-300 uppercase italic"></p>
            </div>
            <nav class="space-y-4">
                <button onclick="showPage('home')" class="w-full text-left p-4 rounded-xl hover:bg-white/10 flex items-center gap-4 font-bold uppercase text-sm"><i class="fas fa-home"></i> Beranda</button>
                <button onclick="showPage('tambah')" class="w-full text-left p-4 rounded-xl hover:bg-white/10 flex items-center gap-4 font-bold uppercase text-sm"><i class="fas fa-plus-circle"></i> Tambah</button>
                <button onclick="logout()" class="w-full text-left p-4 rounded-xl bg-red-500/20 mt-10 border border-white/20 flex items-center gap-4 font-bold uppercase text-sm"><i class="fas fa-power-off"></i> Keluar</button>
            </nav>
        </div>

        <div class="flex-1 p-6 md:p-12 overflow-y-auto">
            <div id="pageHome">
                <h2 class="text-3xl font-black text-blue-900 uppercase italic mb-10 border-b-4 border-cyan-400 pb-2 inline-block">DAFTAR CATATAN MAHASISWA</h2>
                <div id="listCatatan" class="space-y-6"></div>
            </div>

            <div id="pageForm" class="hidden">
                <div class="max-w-3xl mx-auto bg-white p-14 rounded-[40px] shadow-2xl border-2 border-cyan-100">
                    <h2 id="formHeader" class="text-2xl font-black text-blue-900 mb-8 uppercase italic border-b pb-4">BUAT CATATAN BARU</h2>
                    <input type="hidden" id="editId">
                    <div class="space-y-6">
                        <div class="flex gap-2 items-center">
                            <select id="noteMatkul" class="flex-1 p-4 bg-gray-50 border-2 rounded-2xl outline-none focus:border-cyan-400 font-bold">
                                <option>Basis Data</option><option>Sistem Operasi</option><option>Digital Forensik</option>
                                <option>Sistem Jaringan dan Komunikasi</option><option>Fikih Ibadah</option>
                                <option>Testing dan Implementasi Sistem</option><option>Tata Kelola Teknologi Informasi</option>
                                <option>Pemrograman Web</option><option>Praktikum Pemrograman Web</option>
                            </select>
                            <button type="button" onclick="tambahMatkul()" class="bg-cyan-400 text-white w-14 h-[60px] rounded-2xl hover:bg-cyan-500 flex items-center justify-center shadow-md shrink-0">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <input type="text" id="noteJudul" placeholder="Judul Catatan" class="w-full p-4 bg-gray-50 border-2 rounded-2xl outline-none focus:border-cyan-400 font-bold">
                        <textarea id="noteIsi" placeholder="Isi Catatan..." class="w-full p-4 bg-gray-50 border-2 rounded-2xl outline-none focus:border-cyan-400 h-48"></textarea>
                        <div class="flex gap-4">
                            <button onclick="simpan()" class="flex-1 bg-cyan-400 text-white font-black py-4 rounded-2xl shadow-lg uppercase">SIMPAN</button>
                            <button onclick="showPage('home')" class="px-8 bg-gray-200 text-gray-500 font-black py-4 rounded-2xl uppercase">BATAL</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="modalDetail" class="hidden fixed inset-0 bg-blue-900/80 backdrop-blur-md flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-[40px] max-w-2xl w-full p-10 shadow-2xl relative">
            <p id="detMatkul" class="text-cyan-500 font-black mb-1 uppercase italic text-sm"></p>
            <h2 id="detJudul" class="text-3xl font-black text-blue-900 mb-6 uppercase border-b-2 border-gray-100 pb-2"></h2>
            <div id="detIsi" class="text-gray-600 font-black mb-10 whitespace-pre-wrap max-h-96 overflow-y-auto"></div>
            <button onclick="closeDetail()" class="w-full bg-cyan-400 text-white font-black py-4 rounded-2xl uppercase shadow-lg">TUTUP</button>
        </div>
    </div>

    <script>
        const dataMahasiswa = { 
            "101240037": "Ardhi Fajrian Salman", 
            "101140045": "Alma Aulia",
            "101240046": "Brian Avriano",
            "101240047": "Fatimatus Zahro",
            "101240048": "Imelda Saharani",
            "101240049": "Lailatul Dzikriyah",
            "101240050": "M.Amar Murtadlo",
            "101240051": "Dewi Fathina Adiba",
            "101240052": "Muhammad Fahriza",
            "101240053": "M.Fahim Dinanda",
            "101240054": "M.Mahfud Ubaidil Khakim",
            "101240055": "Muhamad Rusmiyanto",
            "101240056": "Muhammad Afiq Fakhri",
            "101240057": "Muhammad Akasah Mardiyanto",
            "101240058": "Muhammad Sulthon Awaludin",
            "101240059": "Nabila Zain",
            "101240060": "Nabilla Ayu Febriani",
            "101240061": "Najwa Septiani Aulia",
            "101240062": "Nica Luspita Dewi",
            "101240063": "Nova Lutfia Rahma",
            "101240064": "Raihanah Aqilah Azizzah",
            "101240065": "Rohmah Maghfiroh",
            "101240066": "Siti Nur Mukarromah",
            "101240067": "Zafira Lutfi Kamiswari",
            "101240068": "Zuhroni",
            "101240069": "Najwa Salsabila",
            "101240070": "M.Izul Khaq Naveda"
        };

        let listUser = JSON.parse(localStorage.getItem('mhs_db_user')) || [];
        let listCatatan = JSON.parse(localStorage.getItem('mhs_db_note')) || [];
        let userAktif = null;

        function initSistem() {
            const session = sessionStorage.getItem('session_user');
            if (session) {
                userAktif = JSON.parse(session);
                document.getElementById('authSection').classList.add('hidden');
                document.getElementById('dashboardSection').classList.remove('hidden');
                document.getElementById('navUser').innerText = `${userAktif.nama} | ${userAktif.nim}`;
                showPage('home');
            }
        }

        function toggleAuth(mode) {
            document.getElementById('loginForm').classList.toggle('hidden', mode !== 'login');
            document.getElementById('regForm').classList.toggle('hidden', mode !== 'reg');
            document.getElementById('resetForm').classList.toggle('hidden', mode !== 'reset');
        }

        function login() {
            const u = document.getElementById('logUser').value.trim();
            const p = document.getElementById('logPass').value.trim();
            if (!u && !p) return alert("username dan password harus di isi terlebih dahulu");
            if (!u) return alert("username harus di isi terlebih dahulu");
            if (!p) return alert("password harus di isi terlebih dahulu");

            const acc = listUser.find(x => x.user === u && x.pass === p);
            if (acc) {
                sessionStorage.setItem('session_user', JSON.stringify(acc));
                initSistem();
            } else { alert("Username atau Password salah!"); }
        }

        function daftar() {
            const nim = document.getElementById('regNim').value.trim();
            const user = document.getElementById('regUser').value.trim();
            const pass = document.getElementById('regPass').value.trim();
            if (!nim && !user) return alert("field harus di isi semua!");
            if (!user && !pass) return alert("username sama pasword harus di isi terlebih dahulu");
            if (!pass && !nim) return alert("pasword sama Nim harus di isi terlebih dahulu");
            if (!nim) return alert("Nim wajib di isi terlebih dahulu");
            if (!user) return alert("username wajib di isi terlebih dahulu");
            if (!pass) return alert("pasword harus di isi terlebih dahulu");
            if (pass.length < 8 || pass.length > 20) return alert("pasword tidak sesuai");

            const sudahAda = listUser.find(x => x.nim === nim);
            if (sudahAda) { return alert("Anda sudah memiliki akun!"); }

            const namaAsli = dataMahasiswa[nim];
            if (!namaAsli) return alert("Nim tidak terdaftar!");
            listUser.push({ nim, user, pass, nama: namaAsli });
            localStorage.setItem('mhs_db_user', JSON.stringify(listUser));
            alert("Pendaftaran Berhasil!"); toggleAuth('login');
        }

        function prosesUbahPassword() {
            const nim = document.getElementById('resNim').value.trim();
            const user = document.getElementById('resUser').value.trim();
            const pass = document.getElementById('resPass').value.trim();
            const idx = listUser.findIndex(u => u.nim === nim && u.user === user);
            if (idx === -1) return alert("Data tidak sesuai!");
            listUser[idx].pass = pass;
            localStorage.setItem('mhs_db_user', JSON.stringify(listUser));
            alert("Password Berhasil Diganti!"); toggleAuth('login');
        }

        function showPage(p) {
            document.getElementById('pageHome').classList.toggle('hidden', p !== 'home');
            document.getElementById('pageForm').classList.toggle('hidden', p !== 'tambah');
            if (p === 'home') {
                tampilkanData();
                document.getElementById('formHeader').innerText = "BUAT CATATAN BARU";
                document.getElementById('editId').value = "";
                document.getElementById('noteJudul').value = "";
                document.getElementById('noteIsi').value = "";
            }
        }

        function tampilkanData() {
            const container = document.getElementById('listCatatan');
            container.innerHTML = "";
            const myNotes = listCatatan.filter(n => n.owner === userAktif.nim);
            myNotes.forEach((n, idx) => {
                const colorClass = `note-${idx % 4}`;
                container.innerHTML += `
                <div class="note-card p-6 rounded-[30px] shadow-md ${colorClass} fade-in mb-4" onclick="bacaDetail(${n.id})">
                    <p class="text-[11px] font-black uppercase mb-1 tracking-widest">${n.matkul}</p>
                    <h2 class="text-2xl font-black uppercase italic">${n.judul}</h2>
                    <p class="text-sm opacity-80 truncate mt-1 italic">${n.isi}</p>
                    <div class="flex justify-between items-center mt-3">
                        <span class="text-[9px] opacity-60 font-bold">${new Date(n.id).toLocaleDateString('id-ID')}</span>
                        <div class="flex gap-2">
                            <button onclick="event.stopPropagation(); event.preventDefault(); siapEdit(${n.id})" class="p-2 bg-white/40 rounded-lg hover:bg-white/60"><i class="fas fa-edit"></i></button>
                            <button onclick="event.stopPropagation(); event.preventDefault(); hapus(${n.id})" class="p-2 bg-white/40 rounded-lg text-red-600 hover:bg-white/60"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>`;
            });
        }

        function bacaDetail(id) {
            const n = listCatatan.find(x => x.id == id);
            document.getElementById('detMatkul').innerText = n.matkul;
            document.getElementById('detJudul').innerText = n.judul;
            document.getElementById('detIsi').innerText = n.isi;
            document.getElementById('modalDetail').classList.remove('hidden');
        }

        function closeDetail() { document.getElementById('modalDetail').classList.add('hidden'); }
       
        function tambahMatkul() {
            const namaBaru = prompt("Masukkan Nama Mata Kuliah Baru:");
            if (namaBaru && namaBaru.trim() !== "") {
                const selectMatkul = document.getElementById('noteMatkul');
                const option = document.createElement('option');
                option.text = namaBaru;
                option.value = namaBaru;
                selectMatkul.add(option);
                selectMatkul.value = namaBaru;
                alert("Mata kuliah '" + namaBaru + "' berhasil ditambahkan!");
            }
        }

        function simpan() {
            const id = document.getElementById('editId').value;
            const j = document.getElementById('noteJudul').value.trim();
            const i = document.getElementById('noteIsi').value.trim();
            const m = document.getElementById('noteMatkul').value;
            if(!j || !i) return alert("Judul dan Isi harus diisi!");
            
            if(id === "") {
                listCatatan.push({ id: Date.now(), owner: userAktif.nim, judul: j, isi: i, matkul: m });
                alert("Catatan Berhasil Ditambahkan!");
            } else {
                const idx = listCatatan.findIndex(n => n.id == id);
                listCatatan[idx] = {...listCatatan[idx], judul: j, isi: i, matkul: m};
                alert("Catatan Berhasil Diperbarui!");
            }
            localStorage.setItem('mhs_db_note', JSON.stringify(listCatatan));
            showPage('home');
        }

        function hapus(id) {
            if(confirm("Hapus Catatan ini?")) {
                listCatatan = listCatatan.filter(x => x.id != id);
                localStorage.setItem('mhs_db_note', JSON.stringify(listCatatan));
                tampilkanData();
            }
        }

        function siapEdit(id) {
            const n = listCatatan.find(x => x.id == id);
            document.getElementById('editId').value = n.id;
            document.getElementById('noteJudul').value = n.judul;
            document.getElementById('noteIsi').value = n.isi;
            document.getElementById('noteMatkul').value = n.matkul;
            document.getElementById('formHeader').innerText = "EDIT CATATAN";
            showPage('tambah');
        }

        function logout() { sessionStorage.clear(); location.reload(); }
        window.onload = initSistem;
    </script>
</body>
</html>